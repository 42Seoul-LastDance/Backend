(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[421],{6587:function(e,t,n){Promise.resolve().then(n.bind(n,7668))},267:function(e,t,n){"use strict";n.d(t,{oV:function(){return a},tO:function(){return c},wH:function(){return s}});var o=n(5726);let s=(0,o.oM)({name:"match",initialState:{isCustom:!1,isMatched:!1,side:""},reducers:{setIsCustom:(e,t)=>{e.isCustom=t.payload.isCustom},setIsMatched:(e,t)=>{e.isMatched=t.payload.isMatched},setSide:(e,t)=>{e.side=t.payload.side}}});s.reducer;let{setIsMatched:a,setSide:c,setIsCustom:r}=s.actions},9586:function(e,t,n){"use strict";n.d(t,{A9:function(){return s},VF:function(){return a}});var o=n(5726);let s=(0,o.oM)({name:"room",initialState:{roomState:[]},reducers:{push:(e,t)=>{e.roomState.push({id:e.roomState.length,name:t.payload.name})}}});s.reducer;let{push:a}=s.actions},5608:function(e,t,n){"use strict";n.d(t,{h:function(){return d},CG:function(){return l}});var o=n(5726),s=n(9586),a=n(267);let c=(0,o.oM)({name:"socket",initialState:{isChanged:!1},reducers:{setIsChanged:(e,t)=>{e.isChanged=t.payload.isChanged}}});c.reducer;let{setIsChanged:r}=c.actions;var i=n(3198);let d=(0,o.xC)({reducer:{room:s.A9.reducer,match:a.wH.reducer,socket:c.reducer}}),l=i.v9},3294:function(e,t,n){"use strict";n.d(t,{GO:function(){return c},U_:function(){return i},hq:function(){return r}});var o,s,a=n(3388);let c=()=>(o&&o.connected?console.log("getChatSocket() : Old socket"):(console.log("getChatSocket()"),(o=(0,a.io)("http://10.14.6.6:3000/RoomChat",{withCredentials:!1})).connect(),o.on("getMessage",e=>{console.log("msg from server : ",e)})),o),r=()=>(s&&s.connected?console.log("getGameSocket() : Old socket"):(console.log("getGameSocket() : New socket"),(s=(0,a.io)("http://10.14.6.6:3000/Game",{withCredentials:!1})).connect()),s),i=()=>{s&&s.connected?(s.disconnect(),console.log("disconnectGameSocket() : disconnect")):console.log("disconnectGameSocket() : not connected")}},7668:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var o,s,a=n(7437),c=n(3198),r=n(5608),i=n(2265),d=n(3294),l=n(267);(o=s||(s={}))[o.NONE=-1]="NONE",o[o.NORMAL=0]="NORMAL",o[o.HARD=1]="HARD";var u=()=>{let[e,t]=(0,i.useState)(!1);(0,r.CG)(e=>e.socket.isChanged);let n=(0,r.CG)(e=>e.match.isCustom),o=(0,c.I0)();var u=(0,d.hq)();return(0,i.useEffect)(()=>(u=(0,d.hq)(),()=>{(0,d.U_)()}),[]),u.hasListeners("handShake")||u.on("handShake",()=>{o((0,l.oV)({isMatched:!0}))}),(0,a.jsx)(a.Fragment,{children:e||n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h1",{children:" Matching... "}),(0,a.jsx)("button",{onClick:()=>{t(!1),u.emit("popQueue")},children:"Cancel Matching"})]}):(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("button",{onClick:()=>{t(!0),u.emit("pushQueue",{gameMode:s.NORMAL,username:"kwsong"})},children:"Start Matching"})})})},h=n(7323),m=()=>{let{unityProvider:e,sendMessage:t,addEventListener:n,removeEventListener:o}=(0,h.JM)({loaderUrl:"/build/Socket.loader.js",dataUrl:"/build/Socket.data.unityweb",frameworkUrl:"/build/Socket.framework.js.unityweb",codeUrl:"/build/Socket.wasm.unityweb"}),[s,u]=(0,i.useState)(!1),[m,g]=(0,i.useState)(!1),k=(0,c.I0)();(0,r.CG)(e=>e.match.isMatched),(0,r.CG)(e=>e.socket.isChanged);let f=(0,r.CG)(e=>e.match.isCustom);var C=(0,d.hq)();return(0,i.useEffect)(()=>(C=(0,d.hq)(),()=>{(0,d.U_)()}),[]),C.hasListeners("startGame")||C.on("startGame",e=>{console.log("! startGame Event Detected"),t("GameManager","StartGame",JSON.stringify(e))}),C.hasListeners("kickout")||C.on("kickout",()=>{console.log("! kickout Event Detected"),k((0,l.oV)({isMatched:!1}))}),C.hasListeners("movePaddle")||C.on("movePaddle",e=>{console.log("! movePaddle Event Detected"),t("Paddle","MoveOpponentPaddle",JSON.stringify(e))}),C.hasListeners("gameOver")||C.on("gameOver",e=>{console.log("! gameOver Event Detected"),t("GameManager","GameOver",JSON.stringify(e)),u(!0),f?g(!1):k((0,l.oV)({isMatched:!1}))}),(0,a.jsxs)(a.Fragment,{children:[!0===s&&(0,a.jsx)("h2",{children:"Game Over!"}),(0,a.jsx)("button",{onClick:()=>{C.emit("getReady"),g(!0)},disabled:m,children:"Get Ready"}),(0,a.jsx)(h.Y4,{unityProvider:e,style:{width:1280,height:720}})]})};let g=()=>{let e=(0,r.CG)(e=>e.match.isMatched);return(0,c.I0)(),(0,a.jsx)(a.Fragment,{children:e?(0,a.jsx)(m,{}):(0,a.jsx)(u,{})})};var k=()=>(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(c.zt,{store:r.h,children:(0,a.jsx)(g,{})})})}},function(e){e.O(0,[148,323,971,864,744],function(){return e(e.s=6587)}),_N_E=e.O()}]);